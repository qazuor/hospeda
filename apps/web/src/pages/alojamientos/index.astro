---
export const prerender = true;

import AccommodationCard from '@/components/accommodations/AccommodationCard.astro';
import EmptyState from '@/components/shared/EmptyState.astro';
import { getAccommodationsByDestination } from '@/data/db';
import Layout from '@/layout/MainLayout.astro';
import { getLangFromUrl, useTranslations } from '@/utils';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);

const accommodations = await getAccommodationsByDestination(); // trae todos si no se pasa destinationId
---

<Layout title={t('accommodations.title')} description={t('accommodations.description')}>
    <section class='bg-gray-50 dark:bg-gray-900 py-12 min-h-screen'>
        <div class='container mx-auto px-4'>
            <div class='mb-10'>
                <h1 class='text-3xl md:text-4xl font-display font-bold mb-2'>{t('accommodations.heading')}</h1>
                <p class='text-gray-600 dark:text-gray-400'>
                    {t('accommodations.subheading', { count: accommodations.length })}
                </p>
            </div>

            {
                accommodations.length === 0 ? (
                    <EmptyState
                        type='accommodations'
                        title={t('accommodations.emptyTitle')}
                        message={t('accommodations.emptyMessage')}
                    />
                ) : (
                    <div class='grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6'>
                        {accommodations.map((acc) => (
                            <AccommodationCard accommodation={acc} />
                        ))}
                    </div>
                )
            }
        </div>
    </section>
</Layout>
